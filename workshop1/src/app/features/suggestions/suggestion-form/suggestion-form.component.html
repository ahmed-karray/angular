<div class="form-container">
    <div class="form-header">
        <h2>üìù Nouvelle Suggestion</h2>
        <p class="subtitle">Partagez vos id√©es pour am√©liorer notre √©tablissement</p>
    </div>

    <form [formGroup]="suggestionForm" (ngSubmit)="onSubmit()" class="suggestion-form">

        <!-- Champ Titre -->
        <div class="form-group">
            <label for="title">
                Titre : <span class="required">*</span>
            </label>
            <input type="text" id="title" formControlName="title" class="form-control"
                [class.invalid]="isFieldInvalid('title')" placeholder="Ex: Am√©liorer la cantine" />

            <!-- Messages d'erreur pour le titre -->
            <div class="error-messages" *ngIf="isFieldInvalid('title')">
                <small class="error" *ngIf="hasError('title', 'required')">
                    ‚ö†Ô∏è Le titre est obligatoire.
                </small>
                <small class="error" *ngIf="hasError('title', 'minlength')">
                    ‚ö†Ô∏è Le titre doit contenir au minimum 5 caract√®res.
                </small>
                <small class="error" *ngIf="hasError('title', 'pattern')">
                    ‚ö†Ô∏è Le titre doit commencer par une majuscule et ne contenir que des lettres.
                </small>
            </div>
        </div>

        <!-- Champ Description -->
        <div class="form-group">
            <label for="description">
                Description : <span class="required">*</span>
            </label>
            <textarea id="description" formControlName="description" class="form-control"
                [class.invalid]="isFieldInvalid('description')" rows="6"
                placeholder="D√©crivez votre suggestion en d√©tail (minimum 30 caract√®res)..."></textarea>

            <!-- Compteur de caract√®res -->
            <div class="char-counter">
                {{ suggestionForm.get('description')?.value?.length || 0 }} / 30 caract√®res minimum
            </div>

            <!-- Messages d'erreur pour la description -->
            <div class="error-messages" *ngIf="isFieldInvalid('description')">
                <small class="error" *ngIf="hasError('description', 'required')">
                    ‚ö†Ô∏è La description est obligatoire.
                </small>
                <small class="error" *ngIf="hasError('description', 'minlength')">
                    ‚ö†Ô∏è La description doit contenir au minimum 30 caract√®res.
                </small>
            </div>
        </div>

        <!-- Champ Cat√©gorie -->
        <div class="form-group">
            <label for="category">
                Cat√©gorie : <span class="required">*</span>
            </label>
            <select id="category" formControlName="category" class="form-control"
                [class.invalid]="isFieldInvalid('category')">
                <option value="" disabled selected>-- S√©lectionnez une cat√©gorie --</option>
                <option *ngFor="let cat of categories" [value]="cat">
                    {{ cat }}
                </option>
            </select>

            <!-- Messages d'erreur pour la cat√©gorie -->
            <div class="error-messages" *ngIf="isFieldInvalid('category')">
                <small class="error" *ngIf="hasError('category', 'required')">
                    ‚ö†Ô∏è La cat√©gorie est obligatoire.
                </small>
            </div>
        </div>

        <!-- Champ Date (readonly) -->
        <div class="form-group">
            <label for="date">Date :</label>
            <input type="date" id="date" formControlName="date" class="form-control readonly" readonly />
        </div>

        <!-- Champ Status (readonly) -->
        <div class="form-group">
            <label for="status">Statut :</label>
            <input type="text" id="status" formControlName="status" class="form-control readonly" readonly />
        </div>

        <!-- Informations -->
        <div class="info-box">
            <p>
                <strong>‚ÑπÔ∏è Informations :</strong>
            </p>
            <ul>
                <li>Les champs marqu√©s d'un <span class="required">*</span> sont obligatoires</li>
                <li>Votre suggestion sera examin√©e par notre √©quipe</li>
                <li>Vous serez notifi√©(e) de la d√©cision</li>
            </ul>
        </div>

        <!-- Boutons d'action -->
        <div class="form-actions">
            <button type="button" class="btn btn-secondary" (click)="onCancel()">
                Annuler
            </button>



            <button type="submit" class="btn btn-primary" [disabled]="suggestionForm.invalid">
                Soumettre
            </button>
        </div>

        <!-- Indicateur de validation du formulaire (pour debug) -->
        <div class="form-status" *ngIf="suggestionForm.invalid">
            <small>
                ‚ö†Ô∏è Veuillez corriger les erreurs avant de soumettre le formulaire.
            </small>
        </div>
    </form>
</div>